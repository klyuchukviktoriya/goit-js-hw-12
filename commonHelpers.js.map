{"version":3,"file":"commonHelpers.js","sources":["../src/js/pixabay-api.js","../src/js/render-functions.js","../src/main.js"],"sourcesContent":["import iziToast from \"izitoast\";\nimport \"izitoast/dist/css/iziToast.min.css\";\nimport axios from \"axios\";\nconst loadMore = document.querySelector(\".js-load-more\");\n\nexport function showError() {\n    iziToast.error({\n        icon: \"\",\n        backgroundColor: \"#ef4040\",\n        position: \"topRight\",\n        message: \"Oh, shit! Type something\",\n        messageColor: \"white\",\n    });\n}\n\nexport let currentQuery = \"\";\n\nexport async function fetchImages(query, page = 1) {\n    currentQuery = query;\n    const BASE_URL = \"https://pixabay.com/api/\";\n    const params = new URLSearchParams({\n        key: \"44041025-2e091a4b621ea033778029d2c\",\n        q: query,\n        image_type: \"photo\",\n        orientation: \"horizontal\",\n        safesearch: true,\n        page: page,\n        per_page: 15,\n    });\n\n    try {\n        const { data } = await axios(`${BASE_URL}?${params}`);\n        if (data.hits.length === 0) {\n            iziToast.error({\n                icon: \"\",\n                backgroundColor: \"#ef4040\",\n                position: \"topRight\",\n                message: \"&#11198; Sorry, there are no images matching your search query. Please, try again!\",\n                messageColor: \"white\",\n            });\n            loadMore.style.display = \"none\";\n        } else {\n            return data.hits;\n        }\n\n    } catch (error) {\n        console.error(error.message);\n    }\n}\n","import SimpleLightbox from \"simplelightbox\";\nimport \"simplelightbox/dist/simple-lightbox.min.css\";\nimport iziToast from \"izitoast\";\nimport \"izitoast/dist/css/iziToast.min.css\";\nimport { fetchImages, currentQuery } from \"./pixabay-api.js\";\n\nlet lightbox;\nconst gallery = document.querySelector(\".gallery\");\nconst loadMore = document.querySelector(\".js-load-more\");\n\nexport function renderGallery(images) {\n\n    gallery.innerHTML = images.map(image => createImageCard(image)).join(\"\");\n    if (lightbox) {\n        lightbox.refresh();\n    } else {\n        lightbox = new SimpleLightbox(\".gallery a\", { captionDelay: 250, captionsData: \"alt\" });\n    }\n    loadMore.style.display = \"block\";\n}\n\nexport function updateGallery(images) {\n    gallery.insertAdjacentHTML(\"beforeend\", images.map(image => createImageCard(image)).join(\"\"));\n    if (lightbox) {\n        lightbox.refresh();\n    }\n}\n\nloadMore.addEventListener(\"click\", onLoadMore);\n\nlet page = 1;\n\nexport async function onLoadMore() {\n\n    if (!currentQuery) {\n        return;\n    }\n\n    page += 1;\n    showLoader();\n\n\n    try {\n\n        const images = await fetchImages(currentQuery, page);\n\n        if (!images || images.length === 0) {\n            hideLoader();\n            iziToast.error({\n                icon: \"\",\n                backgroundColor: \"blue\",\n                position: \"topRight\",\n                message: \"&#11198; We're sorry, but you've reached the end of search results.\",\n                messageColor: \"white\",\n            });\n            loadMore.style.display = \"none\";\n            return;\n        }\n\n        updateGallery(images);\n\n        const lastCard = gallery.lastElementChild;\n        const cardHeight = lastCard.getBoundingClientRect().height;\n\n        window.scrollBy({\n            left: 0,\n            top: cardHeight * 2,\n            behavior: \"smooth\"\n        });\n\n        const totalHits = images.totalHits;\n        const totalPages = Math.ceil(totalHits / 15);\n\n        if (page >= totalPages) {\n            loadMore.style.display = \"none\";\n            iziToast.error({\n                icon: \"\",\n                backgroundColor: \"blue\",\n                position: \"topRight\",\n                message: \"&#11198; We're sorry, but you've reached the end of search results.\",\n                messageColor: \"white\",\n            });\n        }\n\n    } catch (error) {\n        console.error(error.message);\n\n    } finally {\n        hideLoader();\n    }\n}\n\nfunction createImageCard(image) {\n    return `\n    <div class=\"photo-card\">\n      <a class=\"link\" href=\"${image.largeImageURL}\">\n        <img class=\"gallery-image\" src=\"${image.webformatURL}\" alt=\"${image.tags}\">\n        <div class=\"info\">\n        <li><h3 class=\"info-title\">Likes</h3><p class=\"info-text\">${image.likes}</p></li>\n        <li><h3 class=\"info-title\">Views</h3><p class=\"info-text\">${image.views}</p></li>\n        <li><h3 class=\"info-title\">Comments</h3><p class=\"info-text\">${image.comments}</p></li>\n        <li><h3 class=\"info-title\">Downloads</h3><p class=\"info-text\">${image.downloads}</p></li>\n      </div>\n      </a>\n    </div>\n  `;\n}\n\nexport function showLoader() {\n    const loader = document.querySelector(\".loader\");\n    loader.style.display = \"block\";\n}\n\nexport function hideLoader() {\n    const loader = document.querySelector(\".loader\");\n    loader.style.display = \"none\";\n}\n\nexport function clearGallery() {\n    page = 1;\n    const gallery = document.querySelector(\".gallery\");\n    gallery.innerHTML = \"\";\n}\n","import { showError, fetchImages } from \"./js/pixabay-api.js\";\nimport { renderGallery, showLoader, hideLoader, clearGallery } from \"./js/render-functions.js\";\n\nconst searchForm = document.querySelector(\".form\");\nconst input = document.querySelector(\".input\");\nconst loadMore = document.querySelector(\".js-load-more\");\nloadMore.style.display = \"none\";\n\nsearchForm.addEventListener(\"submit\", async (event) => {\n\n    event.preventDefault();\n    clearGallery();\n    const query = input.value.trim();\n\n    if (query.length === 0) {\n        showError();\n        loadMore.style.display = \"none\";\n        return;\n    }\n\n    showLoader();\n    input.value = \"\";\n\n    try {\n        const images = await fetchImages(query);\n        renderGallery(images);\n    } catch (error) {\n        console.log(error.message);\n    } finally {\n        hideLoader();\n    }\n});\n"],"names":["loadMore","showError","iziToast","currentQuery","fetchImages","query","page","BASE_URL","params","data","axios","error","lightbox","gallery","renderGallery","images","image","createImageCard","SimpleLightbox","updateGallery","onLoadMore","showLoader","hideLoader","cardHeight","totalHits","totalPages","loader","clearGallery","searchForm","input","event"],"mappings":"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"}